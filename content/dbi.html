---
title: "Interact with Databases Using DBI"
weight: 5
---

<!-- BLOGDOWN-HEAD -->
<!-- /BLOGDOWN-HEAD -->

<!-- BLOGDOWN-BODY-BEFORE -->
<!-- /BLOGDOWN-BODY-BEFORE -->
<p>The <a href="http://rstats-db.github.io/DBI/">DBI</a> package provides an interface between R and databases; it separates the operations that run against the database from the functions that are exposed to the user and other applications. By doing this, the same R commands can be used to perform the same operations over a variety of databases.</p>
<div id="when-to-use" class="section level2">
<h2>When to Use</h2>
<p>We recommend using <a href="/dplyr/">dplyr</a> for day-to-day data preparation and tidying. The <a href="http://rstats-db.github.io/DBI/">DBI</a> package is a great tool to help with the rest of database-related tasks such as the following:</p>
<ul>
<li>Connecting to and disconnecting from a database</li>
<li>Retrieving the list of tables and fields</li>
<li>Adding or removing tables</li>
<li>Writing data back to a table</li>
<li>Running recurring queries</li>
<li>Executing stored procedures (if supported)</li>
</ul>
<p>The <a href="https://cran.r-project.org/web/packages/DBI/vignettes/spec.html">DBI: R Database Interface</a> provides a comprehensive review of how DBI works.</p>
</div>
<div id="connecting-to-a-database" class="section level2">
<h2>Connecting to a Database</h2>
<p>When using the Connections interface, The RStudio IDE generates an R code snippet that connects to the database (see <a href="/connect/">Connect to a Database</a>).</p>
<p><BR/></p>
<div class="figure">
<img src="conn-setup.png" />

</div>
<p>The connection snippet uses DBIâ€™s <code>dbConnect()</code> command to open the connection. This is the command where we specify the driver, user, password, database name, and other arguments needed to properly start a session with the database. Conversely, <code>dbDisconnect()</code> will close the connection.</p>
</div>
<div id="tables-fields" class="section level2">
<h2>Tables &amp; Fields</h2>
<p>If you are using the RStudio IDE, then exploring an open database connection is as easy as expanding and drilling down into the schema using the Connections tab.</p>
<p>Using code, to get a list of the tables in an existing database connection, use <code>dbListTables()</code></p>
<pre class="r"><code>dbListTables(con)</code></pre>
<pre><code>## [1] &quot;airlines&quot; &quot;airport&quot;  &quot;airports&quot; &quot;faithful&quot; &quot;flights&quot;  &quot;iris&quot;</code></pre>
<p>For a list of the fields in a particular table inside the database connection use <code>dbListFields()</code></p>
<pre class="r"><code>dbListFields(con, &quot;flights&quot;)</code></pre>
<pre><code>##  [1] &quot;year&quot;           &quot;month&quot;          &quot;day&quot;            &quot;dep_time&quot;      
##  [5] &quot;sched_dep_time&quot; &quot;dep_delay&quot;      &quot;arr_time&quot;       &quot;sched_arr_time&quot;
##  [9] &quot;arr_delay&quot;      &quot;carrier&quot;        &quot;flight&quot;         &quot;tailnum&quot;       
## [13] &quot;origin&quot;         &quot;dest&quot;           &quot;air_time&quot;       &quot;distance&quot;      
## [17] &quot;hour&quot;           &quot;minute&quot;         &quot;time_hour&quot;</code></pre>
</div>
<div id="adding-and-removing-tables" class="section level2">
<h2>Adding and Removing Tables</h2>
<p>The <code>dbWriteTable()</code> and <code>dbRemoveTable()</code> can be used to perform their respective operations. The user will need to have the proper database rights to be able to run these operations.</p>
<p>A data frame can be passed to <code>dbWriteTable()</code> to create and simultaneously populate the table:</p>
<pre class="r"><code>library(nycflights13)
dbWriteTable(con, &quot;flights&quot;, flights)</code></pre>
</div>
<div id="running-a-query" class="section level2">
<h2>Running a Query</h2>
<p>The <code>dbGetQuery()</code> command allows us to write queries and retrieve the results. How to best use this command is examined in this article: <a href="/run-queries-safely/">Run Queries Safely</a></p>
</div>
